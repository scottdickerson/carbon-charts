{"version":3,"file":"line.js","sourceRoot":"","sources":["line.ts"],"names":[],"mappings":"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","sourcesContent":["// Internal Imports\nimport { Component } from \"../component\";\nimport * as Configuration from \"../../configuration\";\n\n// D3 Imports\nimport { select } from \"d3-selection\";\nimport { line } from \"d3-shape\";\n\nexport class Line extends Component {\n\ttype = \"line\";\n\n\tlineGenerator: any;\n\n\t// TODORF - Remove these listeners in destroy()\n\tinit() {\n\t\t// Highlight correct scatter on legend item hovers\n\t\tthis.services.events.addEventListener(\"legend-item-onhover\", e => {\n\t\t\tconst { hoveredElement } = e.detail;\n\n\t\t\tthis.parent.selectAll(\"g.lines\")\n\t\t\t\t.transition(this.services.transitions.getTransition(\"legend-hover-line\"))\n\t\t\t\t.attr(\"opacity\", d => {\n\t\t\t\t\tif (d.label !== hoveredElement.datum()[\"key\"]) {\n\t\t\t\t\t\treturn Configuration.lines.opacity.unselected;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn Configuration.lines.opacity.selected;\n\t\t\t\t});\n\t\t});\n\n\t\t// Un-highlight lines on legend item mouseouts\n\t\tthis.services.events.addEventListener(\"legend-item-onmouseout\", e => {\n\t\t\tthis.parent.selectAll(\"g.lines\")\n\t\t\t\t.transition(this.services.transitions.getTransition(\"legend-mouseout-line\"))\n\t\t\t\t.attr(\"opacity\", Configuration.lines.opacity.selected);\n\t\t});\n\t}\n\n\trender(animate = true) {\n\t\tconst svg = this.getContainerSVG();\n\n\t\t// D3 line generator function\n\t\tthis.lineGenerator = line()\n\t\t\t.x((d, i) => this.services.axes.getXValue(d, i))\n\t\t\t.y((d, i) => this.services.axes.getYValue(d, i))\n\t\t\t.curve(this.services.curves.getD3Curve());\n\n\t\t// Update the bound data on line groups\n\t\tconst lineGroups = svg.selectAll(\"g.lines\")\n\t\t\t.data(this.model.getDisplayData().datasets, dataset => dataset.label);\n\n\t\t// Remove elements that need to be exited\n\t\t// We need exit at the top here to make sure that\n\t\t// Data filters are processed before entering new elements\n\t\t// Or updating existing ones\n\t\tlineGroups.exit()\n\t\t\t.attr(\"opacity\", 0)\n\t\t\t.remove();\n\n\t\t// Add line groups that need to be introduced\n\t\tconst enteringLineGroups = lineGroups.enter()\n\t\t\t.append(\"g\")\n\t\t\t.classed(\"lines\", true);\n\n\t\tconst self = this;\n\n\t\t// Enter paths that need to be introduced\n\t\tconst enteringPaths = enteringLineGroups.append(\"path\")\n\t\t\t.attr(\"opacity\", 0);\n\n\t\t// Apply styles and datum\n\t\tenteringPaths.merge(svg.selectAll(\"g.lines path\"))\n\t\t\t.attr(\"stroke\", function (d) {\n\t\t\t\tconst parentDatum = select(this.parentNode).datum() as any;\n\n\t\t\t\treturn self.model.getStrokeColor(parentDatum.label);\n\t\t\t})\n\t\t\t.datum(function (d) {\n\t\t\t\tconst parentDatum = select(this.parentNode).datum() as any;\n\t\t\t\tthis._datasetLabel = parentDatum.label;\n\n\t\t\t\treturn parentDatum.data;\n\t\t\t})\n\t\t\t.transition(this.services.transitions.getTransition(\"line-update-enter\", animate))\n\t\t\t.attr(\"opacity\", 1)\n\t\t\t.attr(\"class\", \"line\")\n\t\t\t.attr(\"d\", this.lineGenerator);\n\t}\n}\n"]}